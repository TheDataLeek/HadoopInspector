{% extends "layout.html" %}

{% block name %}
<h1>Instances</h1>
{% endblock %}

{% block table %}
<thead>
  <tr>
    <th data-field="id" data-align="left" data-sortable="true">#</th>
    <th data-field="name" data-align="left" data-sortable="true">Instance Name</th>
    <th data-field="status" data-align="left" data-sortable="true">Status</th>
    <th data-field="testsrun" data-align="left" data-sortable="true">Tests Run</th>
    <th data-field="violations" data-align="left" data-sortable="true">Violations</th>
  </tr>
</thead>
<tbody>
    {% for row in table_data %}
    <tr>
        <td>{{ loop.index }}</td>
        <td>
            <button type="button" class="btn btn-xs- btn-default" onclick="location.href='/inspect/{{ row[0] }}';">
                {{ row[0] }}
            </button>
        </td>
        <td>
            <h4>
            {% if row[1] == 0 %}
                <span class="label label-success">
                    Passing
                </span>
            {% else %}
                <span class="label label-danger">
                    Failing
                </span>
            {% endif %}
            </h4>
        </td>
        <td>{{ row[2] }}</td>
        <td>{{ row[3] }}</td>
    </tr>
    {% endfor %}
</tbody>
{% endblock %}

{% block js %}
<script>
function convertDataWeek() {
{% for row in history %}
    var {{ table_data[loop.index - 1][0] }} = [
    {% for value in row %}
        {
            x:new Date('{{ value[0] }}'),
            y:{{ 2 * value[1] }}
        }{% if loop.index != history_length %},{% endif %}
    {% endfor %}
    ];
{% endfor %}

    return [
        {% for row in history %}
        {
            values: {{ table_data[loop.index - 1][0] }},
            key: '{{ table_data[loop.index - 1][0] }}',
            color: '{{ colors[loop.index] }}'
        } {% if loop.index != numvals[loop.index] %},{% endif %}
        {% endfor %}
    ];
};
function convertDataMonth() {
{% for row in history %}
    var {{ table_data[loop.index - 1][0] }} = [
    {% for value in row %}
        {
            x:new Date('{{ value[0] }}'),
            y:{{ 3 * value[1] }}
        }{% if loop.index != history_length %},{% endif %}
    {% endfor %}
    ];
{% endfor %}

    return [
        {% for row in history %}
        {
            values: {{ table_data[loop.index - 1][0] }},
            key: '{{ table_data[loop.index - 1][0] }}',
            color: '{{ colors[loop.index] }}'
        } {% if loop.index != numvals[loop.index] %},{% endif %}
        {% endfor %}
    ];
};
function convertDataYear() {
{% for row in history %}
    var {{ table_data[loop.index - 1][0] }} = [
    {% for value in row %}
        {
            x:new Date('{{ value[0] }}'),
            y:{{ 4 * value[1] }}
        }{% if loop.index != history_length %},{% endif %}
    {% endfor %}
    ];
{% endfor %}

    return [
        {% for row in history %}
        {
            values: {{ table_data[loop.index - 1][0] }},
            key: '{{ table_data[loop.index - 1][0] }}',
            color: '{{ colors[loop.index] }}'
        } {% if loop.index != numvals[loop.index] %},{% endif %}
        {% endfor %}
    ];
};
</script>
{% endblock %}
